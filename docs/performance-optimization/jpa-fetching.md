# JPA 성능 최적화 (OSIV off, batch fetch, QueryDSL)

## 문제
- OSIV 활성화는 세션이 길게 유지되어 쿼리 예측이 어렵고 성능 이슈를 만들 수 있다.
- N+1 문제로 인해 조회 성능이 저하될 위험이 있다.

## 개선
- OSIV 비활성화로 트랜잭션 범위 내에서 데이터 접근을 강제.
- batch fetch size(100) 설정으로 컬렉션 조회 쿼리 수를 줄임.
- QueryDSL로 복잡한 조건 검색을 타입 안전하게 구현.

## 효과(정성)
- 데이터 접근 범위가 명확해져 쿼리 추적/튜닝이 쉬워짐.
- 반복 조회를 줄여 응답시간 불확실성이 감소.

## 선택 이유
- OSIV off는 서버 리소스와 추적 가능성을 개선한다.
- batch fetch는 JPA의 기본 로딩 한계를 보완한다.
- QueryDSL은 동적 조건과 유지보수에 적합하다.

## 예상 질문/답변
1) Q: OSIV를 끄면 불편하지 않나요?
   A: 서비스 계층에서 필요한 데이터를 명시적으로 로딩해 예측 가능성이 높아집니다.
2) Q: batch fetch size는 왜 100인가요?
   A: 과도한 조인을 피하면서도 다건 조회를 줄일 수 있는 균형값으로 설정했습니다.
3) Q: QueryDSL을 선택한 이유는?
   A: 복잡한 검색 조건을 타입 안전하게 유지하기 위해서입니다.
4) Q: N+1은 어떻게 확인하나요?
   A: 로그/쿼리 카운트를 확인하고, 필요 시 EntityGraph로 분리합니다.
5) Q: 성능 개선을 어떻게 검증하나요?
   A: 응답시간과 쿼리 수를 비교하고, 재현 시나리오를 기준으로 평가합니다.
