# Redis Failure and Recovery Runbook

## 목적

Redis 장애 시 인증/캐시 경로의 동작을 표준화하고,
복구 절차를 문서화해 운영 리스크를 줄입니다.

## 장애 영향 범위

### 인증

- 영향: Refresh token 재발급 실패 가능
- 기대 동작: 재로그인 유도 (Access 만료 후)

### 대시보드 캐시

- 영향: 캐시 miss 증가로 DB read 증가
- 기대 동작: 기능은 유지, 응답시간만 증가 가능

## 즉시 대응 절차

1. Redis 상태 확인(헬스체크/연결수/메모리)
2. 인증 오류율 상승 여부 확인
3. 대시보드 API p95 급등 여부 확인
4. 서비스 메시지: 재로그인 안내(필요 시)

## 복구 절차

1. Redis 연결 복구
2. 애플리케이션 연결 재확인
3. 인증 재발급 성공/실패 케이스 점검
4. 캐시 hit 비율 정상화 확인
5. 장애 시간대 로그/지표 회고 기록

## 운영 체크리스트

- [ ] `refresh:{email}` 단일 키 규칙 준수
- [ ] 모든 토큰 저장 경로에서 TTL 보장
- [ ] 직렬화 포맷 통일(String)
- [ ] `KEYS` 명령 사용 금지

## 장애 후 회고 템플릿

- 장애 시각/지속시간
- 사용자 영향(로그인 실패율, p95 변화)
- 근본 원인
- 임시 조치
- 영구 조치(코드/설정/문서)
