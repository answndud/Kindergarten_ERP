# Redis + JWT 쿠키 기반 인증 성능 최적화

## 문제
- 세션 기반 인증은 서버 상태 저장 비용이 크고, 수평 확장에 부담이 된다.
- 리프레시 토큰 관리가 없으면 재로그인 빈도가 높아 UX가 저하된다.

## 개선
- JWT를 HTTP-only 쿠키로 저장해 서버 세션 의존도를 낮춤.
- Refresh token은 Redis에 저장하고 TTL로 만료를 관리.
- Refresh token 키를 `refresh:{email}` 단일 키로 관리해 조회/삭제를 O(1) 경로로 단순화.
- 토큰 갱신 시 Redis 저장 토큰과 요청 토큰의 일치 여부를 검증해 재발급 안전성을 강화.

## 효과(정성)
- 서버가 무상태에 가까워져 확장성과 응답 안정성이 향상.
- 재로그인 빈도가 줄어 사용자 경험이 좋아짐.
- 패턴 기반 키 검색을 제거해 운영 환경에서 Redis 부하 리스크를 낮춤.

## 선택 이유
- Redis는 TTL 기반 만료/조회가 빠르고, 토큰 재발급 흐름에 적합.
- JWT 쿠키는 XSS에 강하고, 모바일/웹 공통 인증 흐름 유지가 쉽다.

## 예상 질문/답변
1) Q: 왜 Redis를 사용했나요?
   A: 리프레시 토큰의 빠른 조회와 TTL 만료 처리가 필요했기 때문입니다.
2) Q: 세션 대신 JWT를 선택한 이유는?
   A: 무상태로 서버 부하를 줄이고 수평 확장을 쉽게 하기 위해서입니다.
3) Q: JWT 쿠키가 안전한가요?
   A: HTTP-only 쿠키로 XSS 노출을 줄이고, 서버에서 서명 검증을 수행합니다.
4) Q: Redis 장애 시 어떻게 되나요?
   A: 재로그인이 필요한 상황으로 제한되며, 운영 환경에서 복제/모니터링으로 보완합니다.
5) Q: 토큰 만료 정책은?
   A: Access 토큰은 짧게, Refresh는 TTL로 관리하여 보안을 강화했습니다.
6) Q: 왜 `refresh:{email}` 단일 키로 바꿨나요?
   A: 키 탐색 비용을 줄이고 갱신/로그아웃 경로를 예측 가능한 O(1) 조회/삭제로 만들기 위해서입니다.
